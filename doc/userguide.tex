\documentclass[11pt]{report}
\usepackage[utf8]{inputenc}
\usepackage{mathptm}
\usepackage{newcent}
\usepackage[letterpaper]{geometry}
\usepackage[perpage]{footmisc}
\usepackage{wasysym}
\usepackage{amssymb}
\usepackage{footnote}
\makesavenoteenv{tabular}
\begin{document}
\thispagestyle{empty}
\begin{centering}
  {\Huge eln}
  \vskip30pt

  {\Large an Electronic Lab Notebook}
  \vskip60pt

  {\large By Daniel A. Wagenaar}
  \vfill
  
  {Copyright (c) 2013--2015}
  
\end{centering}
\pagebreak
~
\vfill
\noindent Copyright (C) 2013--2015 Daniel A. Wagenaar\medskip

``eln'' is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see $<$http://www.gnu.org/licenses/$>$.
\pagebreak

\chapter{Introduction}

This document describes the installation and usage of ``eln'', an
electronic lab notebook written by Daniel Wagenaar.  This introduction
will not cover why you should keep a lab notebook, nor why an
electronic lab notebook may be desirable. You already know that.  It
will however, cover some of the ideas behind this particular
implementation.

\section{Why use eln?}

There are any
number of software packages available that implement electronic
notebooks. So why should you choose ``eln''? Eln is for you if:
\begin{itemize}
  \item You want your notes to be stored in a human-readable format.
  \item You want your notes to be stored in a format that will be easy to
    parse electronically even 500 years from now.
  \item You want your notes to be protected against accidental
    deletion.
  \item You want your notes to be automatically dated.
  \item You want to concentrate on entering text and not on
    formatting.
  \item You want to be able to include images and simple graphics with
    your notes and you want that to be easy.
  \item You want your notebook software to be fast, even with 100s
    of pages of notes.
  \item You like your software to be open-source so that you can make
    your own improvements to it, and be confident that you can still
    run it 20 years from now.
\end{itemize}\pagebreak

\noindent However, eln may not be for you if:
\begin{itemize}
  \item You want complete control over the formatting of your notes.
    (Eln will allow you some coarse control.)
  \item You need to typeset complex equations in your notes. (Eln
    will allow you to set basic equations.)
  \item You need to typeset music in your notes.
  \item You need to import formatted documents into your notes. (Eln
    can archive web pages and pdf files for you, but they cannot be
    rendered onto the notebook pages.)
  \item You need a fully polished graphical user interface.
  \item You need a help desk on-call.
\end{itemize}
\noindent Lastly, a note on development. Eln is being developed by an
active research scientist. Practically, that means two things: On the
positive side, it means that I have a vested interest in fixing bugs
and improving eln, because I use it daily. On the negative side, that
means that, by and large, new features are added only when I need them
and bugs are fixed when I have time. I certainly do welcome feature
requests, but I cannot guarantee that they will get implemented
quickly or at all. (If you are in a hurry, I will consider (paid)
consultancy related to eln.) Finally, I definitely welcome
contributions to either the code or the documentation. I would be very
happy if eln turned into a community-supported open source project.

\section{Features}

Eln notebooks consist of ``entries'' that fill one or more pages.
Each entry has a title and consists of paragraphs of text, tables, and/or
graphics canvases. Typesetting is deliberately simple: you can create italics
and bold face text as well as super- and subscripts, but you cannot
choose typefaces or font sizes (except as a global option). These
limits were a conscious design choice: the hope is that this will
force the user to concentrate on content rather than form, just as you
would in a paper notebook.

Graphic manipulation is similarly rudimentary: you can drag-and-drop
or cut-and-paste images and (svg) vector graphics into a notebook
entry, and these graphics can be cropped and resized, but they cannot,
e.g., be rotated or recolored. You can add simple symbols in a limited
set of colors to the graphics as well as draw ``doodles.'' It is also
possible to attach text notes to the graphics. You cannot, however,
create arbitrarily complex graphics in eln; for that, the author
recommends using the GIMP\footnote{http://www.gimp.org.} or
Inkscape\footnote{http://www.inkscape.org.}. It is easy to
cut-and-paste from these programs into eln, and even easier to simply
grab screenshots and paste them into eln.

Eln supports footnotes and references to other pages within the same
notebook, and automatically downloads and archives web pages if you
type their URL into a notebook entry. This, for instance, facilitates
keeping data sheets, MSDSs, and journal articles with your notes.

A key feature of eln is that each entry is stored in a separate
file. (A notebook is a folder on your hard disk with these files in a
subfolder.) This approach has numerous advantages:
\begin{itemize}
  \item It makes for fast
editing regardless of the size of the notebook;
\item It limits the damage
potential of hard disk corruption;
\item It makes it convenient to use
external version control software to archive your notebooks
(Bazaar\footnote{http://bazaar.canonical.com (free and open source despite the
  ``.com'' domain).} and
Git\footnote{http://git-scm.com (ditto).} are
explicitly supported);
\item It facilitates electronically verifying when an
entry was created; and
\item It makes it much easier to manually correct
broken files if somehow data does get compromised.\footnote{Of course
  that's not supposed to happen, but eln, like all software, does have
  bugs, so it is good to know that failure can never be catastrophic.}
\end{itemize}

Another important design feature is that entries automatically get
locked (i.e., become immune to editing) after 24 hours.\footnote{See
  below under ``Editing old entries'' for a minor exception.} This
design choice might be controversial, but it is an important feature
for a lab notebook: it encourages (in fact, enforces), chronological
note taking and discourages manipulating data post-hoc.\footnote{Eln
  on its own cannot be relied on to fully guarantee that entries
  aren't modified post-hoc, because it is certainly possible to modify
  entries using an external text editor. However, judicious use of
  version control software can be used to document that such abuse has
  not occurred.}

Eln does not, at present, offer any facilities for multi-user
collaboration. However, if used in conjunction with version control
software, it is not hard to automatically maintain a central library of
many lab members' notebooks. Lab members can then readily browse each
others' notebooks. In addition, eln can export anything from an
individual page to an entire notebook to pdf.

\section{Contacting the author}

If you like eln or find fault with it, if you discover a bug or have a
suggestion for a new feature, if you are interested in improving this
documentation or have a patch to contribute to the code, I want to
hear from you. My contact information is at
http://www.danielwagenaar.net. I very much look forward to hearing
from you. I realize that this guide is extremely terse, and I
really do welcome questions, particularly if they help me to improve
eln or its documentation.\bigskip

\noindent Pasadena, May 2013;

\noindent Cincinnati, February 2014;

\noindent Woods Hole, June 2015.

\chapter{Installation}

The latest version of the software can always be downloaded from\break
http://www.danielwagenaar.net/eln.

\section{Installing precompiled binaries}

Installation on Windows should be easy using the provided ``eln.msi''
installation package. Installation on Mac OS X should be
straightforward by unpacking the ``eln-mac.tgz'' archive and placing
``eln.app'' anywhere on your hard disk.  Installation on Debian,
Ubuntu, or Mint Linux should be equally easy using the provided
``eln.deb'' installation package. At present, installation on other
flavors of Linux will require compiling the sources yourself, but this
should be straightforward (see below).

Unfortunately, neither Android devices nor iPads are currently
supported, simply because the author doesn't own any. If you are
interested in porting eln to either of these platforms or would like
to commission me to do so, please contact me by email.

Please note that development occurs
primarily on Linux, so the Windows and Mac OS versions may lag
behind.

\section{Compiling the source}
To compile the source,  start from the provided
``eln.tar.gz'' archive or check out the bzr source at http://launchpad.net/eln. You will need
``Qt'' version 4.8 or later. (Eln also compiles with Qt 5.)

\subsection{Compiling on Linux or Mac OS}

You will need a C++ compiler and ``make''. On Linux, this is as simple
as ``sudo apt-get install g++ make''. On Mac OS, you need the
``Command Line tools for XCode'' from the Apple Developers' web
site\footnote{https://developer.apple.com/xcode.}. (I used ``xcode462\_clitools\_10\_76938260a.dmg''.)

Open a terminal and ``cd'' to the root of the unpacked source
archive. Then type ``make'' and fetch a cup of tea. Then, either
manually copy the files ``src/eln'' and
``webgrab/webgrab'' to some location on your PATH, or type ``sudo make
install'' to install into ``/usr/local/bin''.

\subsection{Compiling on Windows}
You will need a C++ compiler. I have successfully used both MinGW and
Microsoft Visual Studio.

First, run ``updatesources.sh'' in the
``tools'' subfolder in a Cygwin shell. Then open, one by one, ``src/eln.pro''
and ``webgrab/webgrab.pro'' in Qt
Creator and follow the standard build steps.

\chapter{Using eln}

Eln has a deliberately sparse user interface that may take a little
getting used to. It is the author's hope, however, that users will
quickly get to appreciate the simplicity of the system.

\section{Some general notes}

Eln is intended to be fully usable either with traditional laptop or
desktop computers or with tablets. To facilitate that, it only uses
the left mouse button and hardly any keyboard modifiers (shift,
control, alt, etc.) It can also be operated exclusively from the
keyboard.

\section{Creating a new notebook}

When eln starts, it displays a list of recent notebooks and offers the
choice of opening a notebook that is not on the list or the create a
new notebook. When you click ``Create new notebook,'' it will
immediately ask you where you want to store that notebook. It will
then open the front page of your notebook, where you can change its
title and add your name as the author as well as your affiliation or
other relevant information. To
leave the front page and go to the table of contents, press ``Page
Down'' on your keyboard.

\section{Creating new entries}

To create a new entry, simply navigate to the last entry (by
repeatedly pressing ``Page Down,'' or more conveniently by pressing
``Control''+``End'') and then press ``Page Down'' once more. A new
untitled entry is created. To encourage you to give your entries
meaningful titles, the cursor is positioned in the title field so you
can start typing right away. (The title you give to your entry here is
automatically copied to the table of contents.) To move from the title
to the first paragraph of your entry, simple press ``Enter'' or ``Tab.''

\section{Adding text}

Select the ``A\raise1pt\hbox{$|$}'' mode icon (by clicking it or
pressing ``F2'') to enter text mode. Click below existing contents or
inside an existing paragraph to start editing. Note that it is not
possible to edit an entry that is not the last one in the book or that
is older than 24 hours.

Navigating between text paragraphs is done using the arrow keys as you
would expect, and you can split and join paragraphs with ``Enter'' and
``Delete'' or ``Backspace'' as you would expect. It is, however, not
possible to join paragraphs across a graphics canvas. Text may be
cut-and-pasted as you would expect using ``Control''+``X,''
``Control''+``C,'' and ``Control''+``V'' as in other programs. What
may not be obvious is that text can be copied from non-editable pages
in text mode (but not browse mode) as well.

\section{Adding graphics}

Graphics can be added by dragging an image file onto the page or by
pressing ``Control''+``V'' to paste an image from the
clipboard. Images (and other graphics objects) can be moved around,
cropped, and resized by selecting the ``hand'' icon (by clicking it or
pressing ``F3''). As a convenience, holding down ``Alt'' in any mode
temporarily selects the ``hand'' icon and enables the same
manipulations.

Various plot symbols and doodles can be added using the ``symbol'' and
``line'' icons (``F4'' and ``F5''). Several choices for symbol size,
line width, and color are available, but these options are not
extendible. (This is a design choice: by limiting the options, eln
hopes to encourage you to not spend too much time thinking about the
perfect color for your annotation.) 

Text annotations can be added
to the graphics canvas using the ``text balloon'' icon (``F6'') and
either clicking to place text or dragging to place text with a
connector line. Type faces and font sizes cannot be changed (again, on
purpose), but you \emph{can} change the width of your annotation by
selecting the ``hand'' icon (``F3'' or ``Alt'') and dragging the right
edge of your annotation. The end of a connector line can be moved by
holding ``Shift'' while dragging the annotation.

Graphics objects can be deleted while in ``hand'' mode by hovering the
cursor over them and pressing ``Delete.'' They can be restored by
pressing ``Insert.'' An empty graphics canvas can be deleted by
pressing ``Delete.''

\section{Adding tables}

Tables can be inserted as their own paragraphs. Simply start typing
the contents of the first table cell, then hit ``Tab'' to create a
second cell. Navigation
within a table is with ``Tab'' and ``Shift''+``Tab'' for left and
right, ``Enter'' and ``Shift''+``Enter'' for next and previous line,
and of course the arrow keys. New columns or rows can be inserted by
holding ``Control'' while navigating. Columns or rows can be deleted
by selecting the entire column or row and pressing ``Delete.''

\section{Saving your work}

You don't have to! Eln automatically saves your work every 10 seconds
(if you have made any changes) and when you navigate to a different
entry (ditto). If you have configured version control (see below),
your changes are automatically committed once you close the
notebook. (Also, changes are automatically committed every 10
minutes.)

\section{Navigation}

Navigation between pages and entries is done using ``Page Up'' and
``Page Down,'' using the scroll wheel of your mouse, or with the
navigation buttons overlaid on the bottom left of the notebook. To go
to the table of contents, press ``Control''+``Home,'' and to go to the
latest entry, press ``Control''+``End.'' Clicking on a page link (hold
``Control'' if the link is on an editable page) activates the
link. Press ``Page Down'' from the final page to start a new entry or
press ``Page Up'' from an untitled, unedited new entry to abandon that
new entry.

\section{Editing old entries}

Cannot be done. Except that you can use the ``text balloon'' icon to
create so-called ``late notes.'' These are automatically set in a
distinct color and decorated with a date stamp. They
may be manipulated just like text annotations on a graphics canvas.

\section{Formatting}

Eln doesn't offer advanced formatting, but it does offer some basic
options: Press ``Control''+``Slash'' to italicize the word under the
cursor or the current selection (or to unitalicize). Press
``Control''+``Star'' (actually ``Control''+``8'') for bold face. Press
``Control''+``Underscore'' (on my keyboard:
``Control''+``Shift''+``Minus'') for underline. Type
``Control''+``Hat'' (actually ``Control''+``6'') to create a
superscript and ``Control''+``Minus'' to create a subscript.

In addition, any text, old or new, can be highlighted using the
``yellow box'' icon (``F7'') or crossed out (``F8'') and these
annotations (only) can be removed using the ``clean'' icon
(``F9''). Highlighting of the selection or word under the cursor can
also be toggled using ``Control''+``Exclamation point'' (that is,
``Control''+``1''). Likewise, ``Control''+``Equals'' toggles
cross-out.

\section{Special characters}

Eln supports most of unicode and---presumably---you can use any input method
supported by Qt to enter text.\footnote{I have only
  tested this with the ``compose'' key method in ``Gnome''; I am
  interested in your test results.} In addition, the following
substitutions are made unconditionally as you type:\medskip

\begin{centering}
\begin{tabular}{c@{\kern.5in}c@{\kern.5in}c@{\kern.5in}c}
\begin{tabular}[t]{cc}
\verb+''+ & '' \\
\verb+'+ & ' \\
\verb+``+ & `` \\
\verb+`+ & ` \\
\verb+--+ & -- \\
\verb+---+ & --- \\
\verb.+-. & $\pm$ \\
$|-$ & $\vdash$ \\
$-|$ & $\dashv$ \\
\end{tabular}
&
\begin{tabular}[t]{cc}
\verb+<-+ & $\leftarrow$ \\
\verb+->+ & $\rightarrow$ \\
$|\,^\wedge$ & $\uparrow$ \\
$|\,|\,^\wedge$ & $\Uparrow$ \\
\verb+<==+ & $\Leftarrow$ \\
\verb+=>+ & $\Rightarrow$ \\
\verb+<-+ & $\leftrightarrow$ \\
\verb+<==>+ & $\Leftrightarrow$ \\
\verb+|->+ & $\mapsto$ \\
\end{tabular}
&
\begin{tabular}[t]{cc}
\verb+>=+ & $\geq$ \\
\verb+<=+ & $\leq$ \\
\verb+!=+ & $\neq$ \\
$^\wedge$\verb+=+ & $\hat=$ \\
\verb+==+ & $\equiv$ \\
$\sim$\verb+=+ & $\cong$ \\
\verb+>>+ & $\gg$ \\
\verb+<<+ & $\ll$ \\
$\sim\sim$ & $\approx$ \\
\end{tabular}
&
\begin{tabular}[t]{cc}
$|\,|$ & $ \parallel $ \\
$|$\verb+=+ & $\models$ \\
\verb+!+$|$\verb+=+ & $\kern.3em/\kern-1em\models$ \\
  \verb+/>+ & $\nearrow$ \\
  \verb+\>+ & $\searrow$ \\
\end{tabular}
\end{tabular}

\end{centering}\bigskip

\noindent (To prevent these automatic substitutions, type the second character
first, move the cursor back, and then type the first
character. Suggestions to improve this procedure are invited.)

In addition to the automatic substitutions, there are many symbols
that can be obtained by typing their name and pressing
``Control''+``Backslash.'' These include all Greek letters, both
lower case and capitals, and the following:

\begin{centering}
\begin{tabular}{c@{\kern.25in}c@{\kern.25in}c@{\kern.25in}c}
\begin{tabular}[t]{cc}
emdash & --- \\
endash & -- \\
figuredash & -- \\
cdot & $\cdot$ \\
cdots & $\cdots$ \\
dots & $\ldots$ \\
deg & $^\circ$ \\
prime & $'$ \\
dprime & $''$ \\
half & $1\over2$ \\
third & $1\over3$ \\
quarter & $1\over4$ \\
\end{tabular}
&
\begin{tabular}[t]{cc}
times \emph{or} x & $\times$ \\
div & $\div$ \\
int & $\int$ \\
sum & $\sum$ \\
sqrt & $\sqrt{}$ \\
flat & $\flat$ \\
sharp & $\sharp$ \\
natural & $\natural$ \\
dagger & $\dagger$ \\
ddagger & $\ddagger$ \\
pilcrow & $\P$ \\
section & $\S$ \\
\end{tabular}
&
\begin{tabular}[t]{cc}
star & $\star$ \\
perp & $\perp$ \\
all \emph {or} A & $\forall$ \\
exists \emph{or} E & $\exists$ \\
in & $\in$ \\
notin & $\notin$ \\
prop & $\propto$ \\
N\footnote{Also Z, Q, R, and C.}  & $\mathbb{N}$\\
d & $\partial$ \\
\end{tabular}
&
\begin{tabular}[t]{cc}
inf & $\infty$ \\
  v & $\downarrow$ \\
  V & $\Downarrow$ \\
diam & $\diameter$ \\
Ohm\footnote{Also kOhm, MOhm, GOhm, and mOhm.} &
$\Omega$ \\
uA\footnote{Also uC, ug, uJ, ul, uL, um, uM, us, uS, and uV.} & $\mu$A \\
&\\
$x$ vec & $\vec x$ \\
$x$ hat & $\hat x$ \\
$x$ tilde & $\tilde x$ \\
$x$ dot & $\dot x$ \\
$x$ ddot & $\ddot x$ \\
\end{tabular}
\end{tabular}

\end{centering}\bigskip

\noindent Note: The last several place accents over the preceding character.

Extending this list is easy, so let me know if you have suggestions.

\section{Footnotes}

Press ``Control''+``N'' to create a footnote. Footnotes are connected
to the main text by arbitrary tags: the word at the cursor
becomes the tag. Footnotes are deleted by deleting the tag in the main
text.

If your tag is a big integer, it is interpreted as a PubMed ID. In
that case, eln will insert the corresponding citation in the note for
you automatically. (If you have suggestions for other kinds of
automatically created note contents, I want to hear from you.)

\section{Hyperlinks}

Press ``Control''+``L'' to create a hyperlink. If you
type an evident URL (e.g., starting with http://), a hyperlink will be
created automatically. Hovering over the link displays a
thumbnail of the first page, and ``Control''+Click opens the
downloaded article (as a pdf). ``Control''+``Shift''+Click opens the
original web page. Hyperlinks are typeset with a pale blue background
once download is complete and with a pink background before download
is complete or if download fails.

\section{Magic links}

Eln recognizes not just URL-style hyperlinks, but also a number of
other ``magic'' links:
\begin{itemize}
\item A small number (at most 3 digits), upon pressing ``Control''+``L''
becomes a hyperlink to another page in the notebook.
\item A large number (more than 4 digits)
will be interpreted as a PubMed ID and will link to PubMed. When
possible, the corresponding article will be automatically downloaded
and archived with the notebook. 
\item Eln will try to interpret Thorlabs part numbers and
  download the data sheet.
\end{itemize}
This ``magic'' can be modified in the ``style.json'' file of a
notebook (see below under ``Customization'') and will be augmented in
future versions to include part numbers from other vendors. Feel free
to put in your requests!

\section{Typesetting quotations, computer code, and other imported materials}

Occasionally it is useful to typeset ``imported'' materials such as
quotations differently from the rest of your notes. In a small
concession to typographic nicety, eln allows you to do this: Place
the cursor at
the beginning of a paragraph and press ``Control''+``Tab.'' The
paragraph will be typeset in a slightly different color, a slightly
smaller point size, and with slightly larger margins. To undo, simply
press ``Control''+``Tab'' again. Similarly, indentation can be
toggled between indented paragraphs (the default), non-indented
paragraphs, and ``dedented'' paragraph, which is useful for typing
bullet lists. This is done by placing the cursor at the beginning of a
paragraph and pressing ``Shift''+``Tab.''

\section{Typesetting mathematics}

When typing mathematical equations, having to frequently press
``Control''+``Backslash'' for special characters and
``Control''+``Slash'' for italics can get tiring. If so, you can press
``Control``+``Back tick'' (that's the key to the left of the ``1'' on
most keyboards) to enter (and exit) ``math'' mode. In math mode,
special characters can be entered simply by typing their name and
single-character words are typeset in italics. Additionally, simple
subscripts and superscripts can be typeset by just typing underscore
or hat followed by the text of the sub- or superscript. As a result, a
basic equation like ``$\int_1^\infty 1/x^2\, \mathrm{d}x = 1$'' can be typeset simple
by typing ``int\_$\!$\_1$^\wedge$inf 1/x$^\wedge$2 dx = 1''.

\section{Exporting and printing}

Eln can export your entire notebook or portions of it to pdf or print
them directly. Simply press ``Control''+``P'' to open the print dialog
and select either ``Print to pdf'' or an actual printer.

\section{Searching your notebook}

Eln incorporates a simple but very useful full-text search
facility. Press ``Control''+``F'' to open the search dialog, type any
word or phrase, and press ``Enter'' or click ``OK.'' A list with
search results from the entire notebook will open; click on a result
to navigate to the relevant entry.

\section{Customization}

At present, you cannot graphically change the looks of a
notebook. However, inside each notebook folder, eln creates a file
called ``style.json'' that defines many of the style parameters of the
notebook. I don't have the time right now to document all of them
(feel free to contribute). Particularly important ones are
``page-width'' and ``page-height'' which specify the width and height
of a notebook page in points (1/72'') and the various
``\ldots-font-family'' variables. Also of interest is the
``magicians'' section.

\section{Version control}

If you turn a notebook into a Bazaar repository (externally, using
``bzr init'') and push it to a server and bind it to the pushed
repository, eln can automatically commit changes if you add ``"vc":
"bzr"'' to your style file. The same happens if you turn your notebook
into a Git repository and add ``"vc": "git"'' to your style file. (If
this paragraph doesn't make sense to you, please first learn about
Bazaar or Git version control, then contact me.)

\end{document}
